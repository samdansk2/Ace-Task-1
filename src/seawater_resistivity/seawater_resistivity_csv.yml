variables:
  temperature: int
  salinity: float
  value: DataFrame
  conductance: float
  resistivity: float
  result: float

functions:
  read_csv:
    module: pandas
    function: read_csv
    arguments:
      filepath: $input['csv']

  calculate_resistivity:
    arguments: [temperature, salinity]
    body: |
      value = df[(df['Temperature (deg C)'] == temperature) & (df['Salinity (%)'] == salinity)]
      
      if value.empty:
        value = df
        conductance = value['Conductance 1/(ohm.cm)'].mean()
      else:
        conductance = value['Conductance 1/(ohm.cm)'].values[0]
      
      resistivity = 1 / conductance
      
      return resistivity

main:
  - read_csv:
      csv: src/seawater_resistivity/input_data.csv
  - input:
      message: "Enter temperature value: "
      variable: temperature
      type: int
  - input:
      message: "Enter salinity value: "
      variable: salinity
      type: float
  - calculate_resistivity:
      temperature: $temperature
      salinity: $salinity
  - variable:
      result: $calculate_resistivity
  - print:
      message: "Resistivity: $result"

